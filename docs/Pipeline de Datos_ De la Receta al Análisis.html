<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Infograf√≠a Completa: Pipeline de Datos Automatizado</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700;800&display=swap" rel="stylesheet">
    <style>
        body {
            font-family: 'Inter', sans-serif;
        }
        .flow-arrow {
            position: relative;
            display: flex;
            align-items: center;
            justify-content: center;
            color: #7F51F2;
        }
        .flow-arrow::after {
            content: '‚Üí';
            font-size: 2.5rem;
            line-height: 1;
            margin: 0 1rem;
        }
        @media (max-width: 767px) {
            .flow-arrow {
                width: 100%;
                transform: rotate(90deg);
                margin: 1rem 0;
            }
            .flow-arrow::after {
                margin: 0;
            }
        }
        .chart-container {
            position: relative;
            width: 100%;
            max-width: 400px;
            margin-left: auto;
            margin-right: auto;
            height: 400px;
            max-height: 400px;
        }
        .step-card {
            border-left: 4px solid #00A6ED;
        }
        .medallion-arrow {
            align-self: center;
            color: #7F51F2;
            font-size: 2.5rem;
            margin: 0 1rem;
        }
    </style>
</head>
<body class="bg-gray-50 text-gray-800">

    <header class="bg-white shadow-md">
        <div class="container mx-auto px-6 py-8 text-center">
            <h1 class="text-4xl md:text-5xl font-extrabold text-gray-900">Pipeline de Datos: De la Receta al An√°lisis</h1>
            <p class="mt-4 text-lg text-gray-600">Una gu√≠a completa que combina la analog√≠a de la cocina con los detalles t√©cnicos.</p>
        </div>
    </header>

    <main class="container mx-auto p-6 md:p-8">

        <section id="analogy" class="mb-20">
            <h2 class="text-3xl font-bold text-center mb-2">1. La Analog√≠a: Nuestra Cocina de Datos üë©‚Äçüç≥</h2>
            <p class="text-center text-gray-600 max-w-3xl mx-auto mb-10">Para entender el flujo, primero imaginemos nuestro sistema como una cocina de lujo.</p>
            <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6 text-center">
                <div class="bg-white p-6 rounded-lg shadow-lg">
                    <div class="text-5xl">üë©‚Äçüíª</div>
                    <h3 class="font-bold text-xl mt-2">La Chef</h3>
                    <p class="text-sm text-gray-600">Eres t√∫, la desarrolladora, creando y mejorando las recetas.</p>
                </div>
                <div class="bg-white p-6 rounded-lg shadow-lg">
                    <div class="text-5xl">üìú</div>
                    <h3 class="font-bold text-xl mt-2">La Receta</h3>
                    <p class="text-sm text-gray-600">Es el c√≥digo Python de nuestro DAG, los pasos para preparar los datos.</p>
                </div>
                <div class="bg-white p-6 rounded-lg shadow-lg">
                    <div class="text-5xl">üêô</div>
                    <h3 class="font-bold text-xl mt-2">El Gerente</h3>
                    <p class="text-sm text-gray-600">Es GitHub, el libro de recetas oficial que guarda la versi√≥n final.</p>
                </div>
                <div class="bg-white p-6 rounded-lg shadow-lg">
                    <div class="text-5xl">ü§ñ</div>
                    <h3 class="font-bold text-xl mt-2">El Supervisor</h3>
                    <p class="text-sm text-gray-600">Es Cloud Build, que se activa cuando llega una nueva receta.</p>
                </div>
            </div>
             <div class="bg-white p-8 rounded-lg shadow-lg mt-8">
                <h3 class="text-2xl font-bold text-center mb-6">El Proceso de Cocina</h3>
                <div class="flex flex-col md:flex-row items-center justify-center gap-4">
                    <div class="text-center">
                        <div class="font-bold">Ingredientes Crudos (CSVs)</div>
                        <div class="mt-2 space-y-2">
                            <div class="bg-blue-100 p-2 rounded text-sm">üìÑ clientes.csv</div>
                            <div class="bg-green-100 p-2 rounded text-sm">üìÑ productos.csv</div>
                            <div class="bg-yellow-100 p-2 rounded text-sm">üìÑ ventas_...csv</div>
                        </div>
                    </div>
                    <div class="text-4xl text-purple-500 mx-4 my-4 md:my-0">‚û°Ô∏è</div>
                    <div class="text-center bg-gray-100 p-6 rounded-lg">
                        <div class="text-4xl">üç≥</div>
                        <div class="font-bold mt-2">La Receta (El DAG)</div>
                         <p class="text-sm text-gray-600">Combina y enriquece la informaci√≥n de cada venta.</p>
                    </div>
                    <div class="text-4xl text-purple-500 mx-4 my-4 md:my-0">‚û°Ô∏è</div>
                    <div class="text-center">
                        <div class="font-bold">El Plato Final (Tabla Gold)</div>
                        <div class="mt-2 bg-yellow-200 border p-3 rounded shadow-md">
                            <p class="text-sm font-mono">Venta #789 | Ana Garc√≠a | Port√°til | 1500‚Ç¨</p>
                        </div>
                    </div>
                </div>
            </div>
        </section>

        <section id="steps" class="mb-16">
            <h2 class="text-3xl font-bold text-center mb-12">2. El Proceso T√©cnico Paso a Paso</h2>
            <div class="space-y-8">
                <div class="bg-white shadow-lg rounded-lg p-6 step-card">
                    <h3 class="text-2xl font-semibold mb-2 text-gray-900">1Ô∏è‚É£ INICIO: La Chef entrega la Receta</h3>
                    <p class="text-gray-600">Todo comienza con un `git push`. El desarrollador sube los cambios del DAG (`.py`) o de la infraestructura (`.tf`) al repositorio en GitHub (El Gerente).</p>
                </div>
                <div class="bg-white shadow-lg rounded-lg p-6 step-card">
                    <h3 class="text-2xl font-semibold mb-2 text-gray-900">2Ô∏è‚É£ TRIGGER: El Supervisor se Activa</h3>
                    <p class="text-gray-600">Un disparador avisa a Cloud Build (El Supervisor) de que ha llegado una nueva receta. El Supervisor lee su checklist: `cloudbuild.yaml`.</p>
                </div>
                <div class="bg-white shadow-lg rounded-lg p-6 step-card">
                    <h3 class="text-2xl font-semibold mb-2 text-gray-900">3Ô∏è‚É£ EJECUCI√ìN: El Supervisor Orquesta el Trabajo</h3>
                    <p class="text-gray-600 mb-4">Cloud Build ejecuta dos tareas cruciales en paralelo:</p>
                    <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                        <div class="bg-blue-50 p-4 rounded-lg border border-blue-200">
                            <h4 class="font-bold text-lg text-blue-800">üìú Tarea 1: Construir la Cocina</h4>
                            <p class="text-blue-700">Ejecuta `terraform apply`. Lee los planos en <strong>main.tf</strong> y construye o actualiza la infraestructura (la despensa, la mesa, etc.).</p>
                        </div>
                        <div class="bg-purple-50 p-4 rounded-lg border border-purple-200">
                            <h4 class="font-bold text-lg text-purple-800">üç≥ Tarea 2: Entregar Receta al Chef</h4>
                            <p class="text-purple-700">Ejecuta `gsutil rsync`. Copia el archivo del DAG al bucket de Cloud Composer (La Cocina).</p>
                        </div>
                    </div>
                </div>
                <div class="bg-white shadow-lg rounded-lg p-6 step-card">
                    <h3 class="text-2xl font-semibold mb-2 text-gray-900">4Ô∏è‚É£ ETL: El Chef Ejecutivo (Airflow) Cocina</h3>
                     <div class="grid grid-cols-1 md:grid-cols-2 gap-6 mt-4">
                        <div class="text-center">
                            <div class="text-4xl">‚è∞</div>
                            <h4 class="font-bold text-lg mt-2">La Alarma Programada</h4>
                            <p class="text-gray-600 text-sm mt-1">La receta (DAG) tiene una instrucci√≥n (`schedule_interval`) que act√∫a como una alarma. Airflow ve la receta y espera pacientemente a que suene la alarma diaria para empezar a cocinar.</p>
                        </div>
                        <div class="text-center">
                             <div class="text-4xl">üöÄ</div>
                            <h4 class="font-bold text-lg mt-2">¬°A Cocinar!</h4>
                            <p class="text-gray-600 text-sm mt-1">Cuando llega la hora programada, Airflow se pone en marcha y ejecuta cada paso de la receta: **Extrae**, **Transforma** y **Carga** los datos.</p>
                        </div>
                    </div>
                </div>
            </div>
        </section>

        <section id="etl-process" class="mb-16">
            <h2 class="text-3xl font-bold text-center mb-8">3. El Proceso ETL al Detalle</h2>
            <div class="bg-white shadow-lg rounded-lg p-8">
                <div class="flex flex-col md:flex-row items-stretch justify-center gap-4">
                    <div class="flex-1 bg-orange-50 border border-orange-200 p-6 rounded-lg text-center">
                        <h3 class="text-xl font-bold mb-4 text-orange-900">1. EXTRACT: Los Ingredientes Crudos</h3>
                        <p class="text-orange-800 mb-4 text-sm">
                            El DAG se conecta a la despensa (`datos_tecnologia`) y lee todos los ingredientes: los archivos de ventas y devoluciones del d√≠a, as√≠ como los datos maestros (clientes, productos, etc.).
                        </p>
                        <div class="flex flex-wrap justify-center gap-2 mb-4">
                            <div class="bg-white p-2 rounded shadow-sm text-xs">üìÑ ventas_...csv</div>
                            <div class="bg-white p-2 rounded shadow-sm text-xs">üìÑ devoluciones_...csv</div>
                            <div class="bg-white p-2 rounded shadow-sm text-xs">üìÑ clientes.csv</div>
                            <div class="bg-white p-2 rounded shadow-sm text-xs">üìÑ productos.csv</div>
                            <div class="bg-white p-2 rounded shadow-sm text-xs">üìÑ categorias.csv</div>
                            <div class="bg-white p-2 rounded shadow-sm text-xs">üìÑ vendedores.csv</div>
                        </div>
                    </div>
                    <div class="hidden md:flex medallion-arrow">‚û°Ô∏è</div>
                    <div class="block md:hidden text-center text-4xl my-4">‚¨áÔ∏è</div>
                    <div class="flex-1 bg-gray-100 p-6 rounded-lg text-center">
                        <h3 class="text-xl font-bold mb-4">2. TRANSFORM: La Magia de SQL</h3>
                        <p class="text-gray-600 mb-4 text-sm">
                            El DAG utiliza consultas SQL para **limpiar** y **unir** los datos. Por ejemplo, une la tabla de ventas con la de clientes para saber el nombre de cada persona.
                        </p>
                        <ul class="space-y-2">
                            <li class="bg-white p-2 rounded shadow-sm text-xs">JOIN `ventas` CON `clientes`</li>
                            <li class="bg-white p-2 rounded shadow-sm text-xs">JOIN `ventas` CON `productos`</li>
                        </ul>
                    </div>
                    <div class="hidden md:flex medallion-arrow">‚û°Ô∏è</div>
                    <div class="block md:hidden text-center text-4xl my-4">‚¨áÔ∏è</div>
                    <div class="flex-1 bg-yellow-50 border border-yellow-200 p-6 rounded-lg text-center">
                        <h3 class="text-xl font-bold mb-4 text-yellow-900">3. LOAD: El Plato Final en BigQuery</h3>
                        <p class="text-yellow-800 mb-4 text-sm">
                            El DAG carga el resultado final del proceso en nuestra tabla de la Capa Gold.
                        </p>
                        <div class="chart-container" style="height: 150px; max-height: 150px; margin-top: 1rem;">
                            <canvas id="goldLayerChart"></canvas>
                        </div>
                         <p class="text-center mt-4 font-semibold text-xs">`gold_ventas_consolidadas`</p>
                    </div>
                </div>
            </div>
        </section>

        <section id="buckets" class="mb-16">
            <h2 class="text-3xl font-bold text-center mb-8">4. Anatom√≠a de los Buckets</h2>
            <div class="bg-white shadow-lg rounded-lg p-6 overflow-x-auto">
                 <p class="text-gray-600 mb-6 text-center">Nuestros almacenes (Buckets) tienen prop√≥sitos muy definidos. Son nuestros almacenes, construidos por el arquitecto (Terraform):</p>
                <table class="w-full text-left border-collapse">
                    <thead class="bg-gray-100">
                        <tr>
                            <th class="p-4 text-lg font-semibold">Icono</th>
                            <th class="p-4 text-lg font-semibold">Bucket</th>
                            <th class="p-4 text-lg font-semibold">Prop√≥sito</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr class="border-b">
                            <td class="p-4 text-3xl text-center">ü™£</td>
                            <td class="p-4 font-semibold">datos_tecnologia</td>
                            <td class="p-4"><b>La Despensa Principal (Bronze)</b> - Ingredientes crudos.</td>
                        </tr>
                        <tr class="border-b">
                            <td class="p-4 text-3xl text-center">üß†</td>
                            <td class="p-4 font-semibold">terraform-state-etl-pipeline</td>
                            <td class="p-4"><b>El Cuaderno del Arquitecto</b> - Estado de Terraform. ¬°No Tocar!</td>
                        </tr>
                         <tr class="border-b">
                            <td class="p-4 text-3xl text-center">üèóÔ∏è</td>
                            <td class="p-4 font-semibold">datos_tecnologia_ab_nuevo_bucket</td>
                            <td class="p-4"><b>Almac√©n Secundario (Silver)</b> - Ingredientes ya limpios.</td>
                        </tr>
                        <tr class="border-b">
                            <td class="p-4 text-3xl text-center">üç≥</td>
                            <td class="p-4 font-semibold">...-composer-envir...</td>
                            <td class="p-4"><b>La Cocina de Airflow</b> - Donde viven las recetas (DAGs).</td>
                        </tr>
                        <tr>
                            <td class="p-4 text-3xl text-center">üìù</td>
                            <td class="p-4 font-semibold">...-cloudbuild-logs</td>
                            <td class="p-4"><b>El Diario del Supervisor</b> - Logs de cada despliegue.</td>
                        </tr>
                    </tbody>
                </table>
            </div>
        </section>
        
        <section id="next-steps" class="mb-16">
            <h2 class="text-3xl font-bold text-center mb-8">5. Pr√≥ximos Pasos Estrat√©gicos</h2>
            <p class="text-center text-gray-600 max-w-3xl mx-auto mb-10">Basado en el Plan de Acci√≥n 2025-2026 para evolucionar la plataforma.</p>
            <div class="grid grid-cols-1 md:grid-cols-2 gap-8">
                <div class="bg-white rounded-lg shadow-lg p-8">
                    <div class="text-center mb-4"><span class="text-5xl">üö®</span></div>
                    <h3 class="text-2xl font-bold mb-4 text-center">Fase 1: Robustecimiento y Alertas</h3>
                    <div class="text-sm space-y-3">
                        <p><strong>Objetivo:</strong> Aumentar la visibilidad sobre la salud del pipeline y asegurar la resiliencia.</p>
                        <ul class="list-disc list-inside text-gray-600">
                            <li>Implementar alertas en Cloud Monitoring (Slack/Email).</li>
                            <li>Agregar Tests Unitarios y de Integraci√≥n autom√°ticos.</li>
                            <li>Documentar procedimientos de Rollback.</li>
                        </ul>
                    </div>
                </div>
                <div class="bg-white rounded-lg shadow-lg p-8">
                    <div class="text-center mb-4"><span class="text-5xl">üìä</span></div>
                    <h3 class="text-2xl font-bold mb-4 text-center">Fase 2: Optimizaci√≥n y Visualizaci√≥n</h3>
                    <div class="text-sm space-y-3">
                        <p><strong>Objetivo:</strong> Mejorar la eficiencia y extraer valor visible para el negocio.</p>
                        <ul class="list-disc list-inside text-gray-600">
                            <li>Optimizar BigQuery (Clustering y Particionamiento).</li>
                            <li>Crear Dashboard de Negocio en Looker Studio.</li>
                            <li>Reducir costos de consultas.</li>
                        </ul>
                    </div>
                </div>
            </div>
        </section>
        
        <section id="conclusion" class="text-center">
            <div class="max-w-3xl mx-auto bg-white shadow-xl rounded-lg p-10 border-t-8 border-purple-500">
                <h2 class="text-3xl font-extrabold text-gray-900 mb-4">Conclusi√≥n: De Datos Crudos a Inteligencia de Negocio</h2>
                <p class="text-lg text-gray-600 mb-6">Hemos automatizado la f√°brica de datos para que cada d√≠a, a la hora programada, nuestra cocina se ponga en marcha de forma autom√°tica y fiable. Esto se traduce en:</p>
                <div class="flex justify-center flex-wrap space-x-2 md:space-x-8 text-lg">
                    <div class="flex items-center space-x-2 text-green-600 font-semibold mb-2">
                        <span class="text-xl">‚úÖ</span>
                        <span>Datos listos para la toma de decisiones</span>
                    </div>
                    <div class="flex items-center space-x-2 text-green-600 font-semibold mb-2">
                        <span class="text-xl">‚úÖ</span>
                        <span>Eficiencia y reducci√≥n de errores</span>
                    </div>
                    <div class="flex items-center space-x-2 text-green-600 font-semibold mb-2">
                        <span class="text-xl">‚úÖ</span>
                        <span>Menos costes de infraestructura</span>
                    </div>
                </div>
            </div>
        </section>

    </main>

    <footer class="text-center py-8 mt-8 bg-gray-100">
        <p class="text-gray-500">&copy; 2025 Proyecto Tienda Ventas Tecnolog√≠a AB</p>
    </footer>

    <script>
        document.addEventListener('DOMContentLoaded', function () {
            const processLabel = (label) => {
                const maxLength = 16;
                if (label.length <= maxLength) { return label; }
                const words = label.split(' ');
                const lines = [];
                let currentLine = '';
                for (const word of words) {
                    if ((currentLine + ' ' + word).trim().length > maxLength) {
                        lines.push(currentLine.trim());
                        currentLine = word;
                    } else {
                        currentLine = (currentLine + ' ' + word).trim();
                    }
                }
                if (currentLine) { lines.push(currentLine.trim()); }
                return lines;
            };
            const tooltipTitleCallback = (tooltipItems) => {
                const item = tooltipItems[0];
                let label = item.chart.data.labels[item.dataIndex];
                if (Array.isArray(label)) { return label.join(' '); }
                return label;
            };
            const ctx = document.getElementById('goldLayerChart').getContext('2d');
            const goldLayerChart = new Chart(ctx, {
                type: 'doughnut',
                data: {
                    labels: ['Laptops', 'Smartphones', 'Accesorios', 'Componentes'].map(processLabel),
                    datasets: [{
                        label: 'Ventas por Categor√≠a',
                        data: [45, 25, 20, 10],
                        backgroundColor: ['#00A6ED', '#7F51F2', '#F251A3', '#F2D851'],
                        borderColor: '#FFFFFF',
                        borderWidth: 2,
                        hoverOffset: 4
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        legend: { display: false },
                        tooltip: { callbacks: { title: tooltipTitleCallback }, padding: 10, boxPadding: 3 }
                    },
                    cutout: '60%'
                }
            });
        });
    </script>
</body>
</html>
